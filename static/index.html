<!DOCTYPE html>
<html>
<head>
  <title>Hello World</title>
  <script type="text/javascript" src="/socket.io/socket.io.js"></script>
</head>
<body>
<h1>Socket gets loaded on page</h1>

<p>Call io() in the console to make a connection</p>

<input type="text" name="" id="inputName">
<input type="submit" name="" id="submit">

<ol id="text">
  <li>First item - hardcoded</li>
</ol>

<script type="text/javascript">

// Set room name from the URL
const roomName = window.location.pathname.split("/")[1];
console.log(roomName);

  var socket = io({transports: ['websocket'], upgrade: false, roomName: 'qwerty'});

  // Browser can't join the room but it tells server what
  // room it wants to join
  socket.emit('room.join', roomName);

  var addListItem = (message) => {
    var li = document.createElement('li');
    li.appendChild(document.createTextNode(message));
    document.getElementById('text').appendChild(li);
  }

  document.getElementById('submit').addEventListener('click', (e) => {
    var userName = document.getElementById('inputName').value;
    socket.emit('pingFromWeb', {name: userName, room: roomName});
  });

  socket.on('user.events', addListItem);
  socket.on('sendDogName', (data) => {
    addListItem('Your dog name is ' + data);
  });

</script>


</body>
</html>
